---
layout: post
status: publish
published: true
title: PLD, poldek and vendor locks
author: Patrys
author_login: admin
author_email: patrys@pld-linux.org
author_url: http://room-303.com/blog/
wordpress_id: 378
wordpress_url: http://room-303.com/blog/2007/05/30/pld-poldek-and-vendor-locks/
date: 2007-05-30 20:16:52.000000000 +02:00
categories:
- linux
- software
tags: []
comments:
- id: 7990
  author: Michał Górny
  author_url: http://mgorny.openid.pl/
  date: '2007-05-30 21:48:28 +0200'
  date_gmt: '2007-05-30 20:48:28 +0200'
  content: And it would be nice to add some kind of dividing packages into user-wanted
    and dependency-installed, like emerge or aptitude does.
- id: 7993
  author: carstein
  author_url: http://carstein.jogger.pl
  date: '2007-05-30 23:33:32 +0200'
  date_gmt: '2007-05-30 22:33:32 +0200'
  content: "problem doesn't (zamiast problem don't)\r\nPewnie będzie więcej, ale na
    razie nie skończyłem czytać."
- id: 7996
  author: Łukasz Kowalczyk
  author_url: ''
  date: '2007-05-31 08:20:50 +0200'
  date_gmt: '2007-05-31 07:20:50 +0200'
  content: "Ja też nie byłem w stanie skończyć lektury, bo jest zbyt bolesna.  \"Noone\"
    należy pisać oddzielnie, \"and all the above my seem\" -- bez komentarza, \"know
    C WELL enough\", \"more details later below\" -- dlaczego later, skoro można o
    tym przeczytać już teraz?\r\n\r\nItd, itd.  Na miejscu anglojęzycznego czytelnika
    wolałbym chyba przetłumaczyć sobie polski tekst przy pomocy babelfisha."
- id: 7997
  author: gorzki
  author_url: ''
  date: '2007-05-31 09:44:23 +0200'
  date_gmt: '2007-05-31 08:44:23 +0200'
  content: 'in short: Polish is better :)'
- id: 7998
  author: Pvt
  author_url: ''
  date: '2007-05-31 12:57:39 +0200'
  date_gmt: '2007-05-31 11:57:39 +0200'
  content: "Ale macie coś do powiedzenia w temacie? Czy tylko tak wpadliście potrollować?\r\n\r\n--\r\n\r\nSłabo
    w temacie jestem, kiedyś słyszałem sporo dobrego o poldku, ale z twoich słów wynika,
    że nie jest tak różowo. Osobiście proponowałbym przejście na któreś ze znanych
    rozwiązań. O ile oczywiście High Council of PLD nie cierpi na syndrom NIH ;-)."
- id: 7999
  author: Lipa
  author_url: ''
  date: '2007-05-31 14:38:18 +0200'
  date_gmt: '2007-05-31 13:38:18 +0200'
  content: Używam PLD i w zasadzie jestem zadowolony z poldka; ale jeśli rzeczywiście
    w przyszłości mogą z nim być problemy to może zastanowić się nad przejściem na
    yum? (dużo dobrego słychać także o smarcie).
- id: 8000
  author: Patrys
  author_url: http://room-303.com/
  date: '2007-05-31 14:52:45 +0200'
  date_gmt: '2007-05-31 13:52:45 +0200'
  content: "Carstein:\r\n\r\nNie potrafię znaleźć w kodzie notki kawałka, który chcesz,
    żebym poprawił.\r\n\r\nŁukasz Kowalczyk:\r\n\r\nSerdecznie dziękuję wszystkim,
    którzy zajęli się wyłapywaniem literówek w tekście pisanym o 20 w biurze, po 11
    godzinach pracy. Szkoda, że zupełnie nie interesuje was merytoryczna zawartość
    notki."
- id: 8001
  author: cli3nt
  author_url: http://bsd.miki.eu.org/~cli3nt/
  date: '2007-05-31 16:07:59 +0200'
  date_gmt: '2007-05-31 15:07:59 +0200'
  content: "@Patrys: Nie usprawiedliwiaj sie wymowkami typu \"pisalem to po 11 godzinach
    pracy\" bo albo umiesz angielski i go uzywasz albo go nie umiesz i go nie uzywasz,
    a jezeli juz uzywasz i robisz bledy to nie wykrecaj sie tego typu tekstami bo
    to jest hmmm \"preety lame\"; po prostu zrobiles bledy i juz, ladnie podziekuj
    (bez ironii) i zapamietaj na przyszlosc.\r\n\r\nCo do poldka, ba calego PLD, to
    wydaje mi sie, ze trzeba byloby zrobic liste rzeczy do poprawienia i nadac im
    range, cos w stylu natychmiast-pozniej-jeszcze_pozniej i zaczac po kolei szukac
    ludzi ktorzy podejma sie poprawiania, a tacy predzej czy pozniej sie znajda :)."
- id: 8002
  author: Patrys
  author_url: http://room-303.com/
  date: '2007-05-31 16:31:15 +0200'
  date_gmt: '2007-05-31 15:31:15 +0200'
  content: "cl3nt:\r\n\r\nJeśli poprawki literówek \"my\" na \"may\" i tym podobne
    uznajesz za powód do pisania o nieznajomości języka...\r\n\r\nJedyna rzecz, jaką
    faktycznie spieprzyłem, to zamiana \"a good grasp on C\" na \"know C good enough.\"
    I to zmieniłem na \"well enough,\" zgodnie z uwagą."
- id: 8003
  author: grizz
  author_url: http://grizz.pl
  date: '2007-05-31 18:36:11 +0200'
  date_gmt: '2007-05-31 17:36:11 +0200'
  content: "Z punktu widzenia zwykłego użytkownika \"desktopowego\".\r\n\r\nPrędkośc
    działania poldka (wyszukiwanie zależności) jest o niebo lepsza niż ta, która doświadczyłem
    w yumie.\r\n\r\nWygoda obsługoi też nieporównywalna (w trybie interaktywnym).\r\n\r\nAktualnie
    uzywam Archa (lepsze wsparcie dla desktopowych paczek w repo ;)) i własnie poldka
    brakuje mi najbardziej.\r\n\r\nAle to tylko opinia szarego użyszkodnika ;)"
- id: 8005
  author: ljarochowski
  author_url: ''
  date: '2007-06-01 09:00:18 +0200'
  date_gmt: '2007-06-01 08:00:18 +0200'
  content: "Szczerze mówiąc, to używałem PLD przez kilka ładnych lat (od wczesnego
    Ra, do jakiegoś roku temu), na serwerach nadal używam...\r\n\r\nco do poldka:\r\njako
    użytkownik tego narzędzia nie mam zastrzeżeń jest w porządku. Czasami brakuje
    mi opcji jak w apcie autoremove, żeby usunąć śmietnik bibliotek (nie potrzebnych).\r\n\r\nco
    do samego PLD:\r\nzrezygnowałem, bo nie ma stabilnych wydań - Ac ukazało się teraz,
    w distro imho jest jeden wielki burdel - wszyscy podchodzą do tego \"jak chcesz
    to se zrób\" nie ma żadnej ogólnej myśli przewodniej, żadnego lidera w sumie -
    jest to podejście które doskonale rozumiem, ale mi się ono nie podoba. Cały czas
    wszystko kręci się w kółko. MMazur obiecywał stabilne Ac hen hen, dawno temu ...
    Domyślam się że z Th będzie tak samo, stabilne zobaczymy za 5 lat.\r\n\r\nW PLD
    jest najlepszy chyba podział pakietów (np. moduły php, apache itd) jaki widziałem,
    wiele rzeczy jest super dopieszczonych - domyślne konfigi, rs-scripts itd. W ogóle
    uważam PLD za świetne distro, ale na serwerach będę instalował debiana (albo na
    życzenie centosa).\r\n\r\nNa desktopie - ubuntu, w sumie jedna z lepszych distro
    na desktop. (żeby nie było że jestem lamerem co to w konsoli nie umie się obsługiwać
    - używałem pld na desktopie bez Xów przez 2-3 lata)\r\n\r\nTego posta przeczytałem
    z pewną nadzieją, nadzieją, że moja ulubiona dystrybucja  zmierza w dobrym kierunku
    (tj. poprawianie fuckupów).\r\n\r\nPozdrawiam\r\nŁukasz Jarochowski\r\n\r\nPS:
    rozumiem podejście developerów PLD do PLD, więc jeśli ktoś chce odpowiedzieć,
    żebym dzisiaj usiadł i zaczął poprawiać to distro - to już mówię, że dziękuję
    postoję. Na szczęście w świecie OS jest mnogość wyboru."
- id: 8006
  author: Ktos
  author_url: http://www.ktos.info
  date: '2007-06-01 10:49:49 +0200'
  date_gmt: '2007-06-01 09:49:49 +0200'
  content: "Ja używam Linuksa, w tym PLD bardzo dorywczo, ale ostatnio jestem zmuszony
    używać dwóch dystrybucji opartych o yuma właśnie - CentOS i Fedory. I powiem jedno
    - jak zobaczyłem yuma, to zacząłem kompilować poldka dla Fedory ;-)\r\n\r\nWygoda
    obsługi (zwłaszcza tryb interaktywny), szybkość działania... naprawdę bardzo fajny
    projekt i była by wielka szkoda, gdyby poldka zabrakło. Bo jest to też coś, co
    bardzo odróżnia PLD od innych dystrybucji (oczywiście poza rozbiciem paczek, ich
    aktualnością oraz ilością, które też baaardzo cenię), IMO bez poldka to prawie
    nie ma PLD."
- id: 8007
  author: Patrys
  author_url: http://room-303.com/
  date: '2007-06-01 12:09:17 +0200'
  date_gmt: '2007-06-01 11:09:17 +0200'
  content: Czemu wszyscy traktują ten post jako próbę zastąpienia poldka czymkolwiek?
    Wyżej pokazałem tylko, że w poldku jest jeszcze dużo do zrobienia i że warto dodać
    <em>drugi wspierany</em> program do zarządzania pakietami, bo inaczej któregoś
    dnia możemy się obudzić z ręką w nocniku.
- id: 8008
  author: ljarochowski
  author_url: ''
  date: '2007-06-01 14:38:12 +0200'
  date_gmt: '2007-06-01 13:38:12 +0200'
  content: kiedyś był apt w PLD, co z nim teraz?
- id: 8010
  author: shadzik
  author_url: http://shadzik.jogger.pl
  date: '2007-06-01 16:28:21 +0200'
  date_gmt: '2007-06-01 15:28:21 +0200'
  content: "\"Czemu wszyscy traktują ten post jako próbę zastąpienia poldka czymkolwiek?\"\r\n\r\nBo
    tak napisałeś i kropka. Patryś jesteś kolejną osobą, w której wyczuwam tylko i
    wyłącznie gonitwę za numerkami. Owszem, w ostatnim czasie RPM zaczął się szybko
    rozwijać, ale zamiast narzekać na to, że poldek to przestarzałe gówno (tak wynika
    z Twojego opisu) i rezygnować z jednak flagowego produktu PLD na rzecz wiele gorszego,
    ale maintainowanego Yuma, to należałoby na spokojnie takie błędy poldkowe wylistować,
    znaleźć ludzi którzy by spokojnie zrozumieli kod poldka i zaczęli go poprawiać
    i dopiero wtedy gonić (ach jak bardzo) nam uciekającego rpma. Zawsze można zacząć
    pisać poldka2 który by już poprawnie korzystał z librpm i wnosił dobrze udokumentowaną
    libpoldek2, która dałoby się wykorzystać do napisania odpowiedniego GUI."
- id: 8011
  author: Patrys
  author_url: http://room-303.com/
  date: '2007-06-01 16:38:37 +0200'
  date_gmt: '2007-06-01 15:38:37 +0200'
  content: "shadzik:\r\n\r\nKurs czytania dla najmłodszych:\r\n\r\n<blockquote>The
    other solution is to introduce a new package manager with equal rights to those
    of poldek.</blockquote>\r\n\r\nA teraz reiteruj proszę przez swoją wypowiedź powyżej."
- id: 8012
  author: shadzik
  author_url: http://shadzik.jogger.pl
  date: '2007-06-01 16:46:09 +0200'
  date_gmt: '2007-06-01 15:46:09 +0200'
  content: I to jest pełna Twoja riposta? Narzekasz, że inni czepiają się tylko błędów
    a nie wnoszą nic do tematu, a teraz sam tak robisz? Bardzo dorosły jesteś. Ale
    dobrze, wytłumaczę się z moich oszczerstw. Czytając pełny Twój artykuł można odnieść
    takie wrażenie jakie opisałem wyżej. Gdyby było inaczej przeczytałbym tylko końcówkę
    i prawdopodobnie nic nie odpisał.
- id: 8013
  author: Patrys
  author_url: http://room-303.com/
  date: '2007-06-01 16:53:08 +0200'
  date_gmt: '2007-06-01 15:53:08 +0200'
  content: "shadzik:\r\n\r\nRiposta na co? Yum nie jest \"wiele gorszy,\" ja nie proponowałem
    wywalenia poldka, a propozycję znalezienia programistów dla poldka znajdziesz
    w moim poście powyżej. Do której części miałbym się odnieść?\r\n\r\nJeśli chodzi
    o poldek2, to z mmazurem i hawkiem rozmawialiśmy o zrobieniu shella opartego na
    yumie."
- id: 8014
  author: jpc
  author_url: http://jpc.jogger.pl
  date: '2007-06-01 19:47:58 +0200'
  date_gmt: '2007-06-01 18:47:58 +0200'
  content: "Jedyny problem jest taki, że yum jest wolny jak cholera i wygląda mi to
    na problem raczej algorytmiczny, a nie przypadkowy.\r\n\r\nProblem z alternatywami
    do poldka jest taki, że poldek bije wszystko na głowę jeśli chodzi o wygodę użytkowania.
    Brakuje mu API, ale nie wiem czy jakość API jest ważniejsza od jakości programu
    (akurat w tym wypadku)."
- id: 8018
  author: grizz
  author_url: http://grizz.pl
  date: '2007-06-02 09:48:30 +0200'
  date_gmt: '2007-06-02 08:48:30 +0200'
  content: pacman z Archa szybkością poldak spokojnie goni, ale brak mu wygodnego
    trybu interaktywnego - są wtyczki do basha i zsh z autouzupełnianiem nazw pakietów,
    ale to jeszcze nei to :/
- id: 8020
  author: ljarochowski
  author_url: ''
  date: '2007-06-02 17:15:27 +0200'
  date_gmt: '2007-06-02 16:15:27 +0200'
  content: "a jaki jest problem z użytecznością takiego apta? Przecież na to jest
    sto tysięcy nakładek gui, cli cokolwiek??\r\n\r\nCzemu tego nie używać, skoro
    to kiedyś było w PLD?"
- id: 8021
  author: andrzejk
  author_url: http://www.andrzejk.info/
  date: '2007-06-02 23:19:45 +0200'
  date_gmt: '2007-06-02 22:19:45 +0200'
  content: "@shadzik\r\n\r\nNie wiem jak Ty. Ja przeczytałem post i dla mnie był on
    informacją, że poszukiwani są ludzie do rozwijania PLD i dodatkowo szukane jest
    rozwiązanie, które pozwoli na sprawne zarządzanie pakietami/paczkami. \r\n\r\nWiec..
    o czym w ogóle mówisz??\r\n\r\n@patrys\r\n\r\nNie używam linuxa - niestety, nie
    ma na niego PS, który jest mi niezbędny, ale ciekaw jestem jak się ma PLD do rzeczywistości...
    może skuszę się na testy ;)"
- id: 8023
  author: Krymzon
  author_url: http://Krymzon.myopenid.com/
  date: '2007-06-04 11:24:44 +0200'
  date_gmt: '2007-06-04 10:24:44 +0200'
  content: "W moim, niedeveloperskim, odczuciu tryb interaktywny poldka bije podobne,
    tekstowe, na głowę. Jednak możliwość użycia GUI jest dla mnie ważniejsza. Teraz
    używam apta/aptituda (nieinteraktywnie) gdy wiem, co konkretnie chcę zainstalować,
    oraz Synaptica, gdy muszę czegoś poszukać. Brakuje mi czasami funkcjonalności
    poldka, jednak generalnie jest mi wygodniej.\r\n\r\nSkoro największe problemy
    w kodzie są z łącznością z rpmem i generalnie samymi operacjami na pakietach,
    może sensownie byłoby spróbować przenieść UI poldka do innego menadżera?"
- id: 8032
  author: hez
  author_url: ''
  date: '2007-06-05 12:11:23 +0200'
  date_gmt: '2007-06-05 11:11:23 +0200'
  content: "@Krymzon\r\nJest przecież \"poldex\", który imo wygląda bardzo podobnie
    do aptitude."
- id: 8034
  author: Krymzon
  author_url: http://Krymzon.myopenid.com/
  date: '2007-06-05 13:17:02 +0200'
  date_gmt: '2007-06-05 12:17:02 +0200'
  content: Tak, jest. Ale jak napisałem, nie uruchamiam trybu interaktywnego aptitude.
    Aptitude używam prawie tylko do sprawdzania opisu pakietów w terminalu (aptitude
    show) albo instalacji wraz z zalecanymi. Jak potrzebuję czegoś typu poldex, odpalam
    Synaptica.
---
<p>This post will be entirely in English but feel free to comment in Polish if you want. The reason is my laziness as I need to provide an English translation anyway and it's just easier to write one version instead of two.</p>

<p><strong>Troll warning:</strong> I am sane and have spent more than <a href="http://cia.vc/stats/author/patrys">last 3 years</a> actively <em>developing</em> PLD Linux. If you want to tell me to shut up, you better find something to support your statements.</p>

<h4>The problem</h4>

<p>Or several problems really:</p>

<ul>
<li>The first and most obvious one is poldek still has some bugs.</li>
<li>That in turn is caused by the fact that noone is working on poldek any more.</li>
<li>The above is caused by poldek's poor source code documentation.</li>
<li>That in fact is because there is only one author and maintainer.</li>
</ul>

<p>And sure all the above may not seem immediate. That is, until you realize Mis (Paweł Gajda) &mdash; despite having good intentions &mdash; can no longer spend his time actively working on the project. It might not be obvious at first but check the spec in our CVS. The last snapshot was taken four months ago and we already have 6 patches on top of that. This is not bad if we are talking about an upstream project. But here upstream is actually us.</p>

<p>I am afraid that one day we might be unable to follow rpm in terms of both features and compatibility. There are some people today who know C well enough to hack on the sources and a small percentage of them is actually capable of understanding poldek's internals but one day there may be none.</p>

<p>But the problems don't end here. Poldek was a marvellous tool back when it was created. In the dark ages of early apt we already had an interactive tool to use. But today the situation is quite different:</p>

<ul>
<li>Fedora/RHEL are actively working on yum.</li>
<li>Gentoo is actively maintaining emerge.</li>
<li>Debian/Ubuntu have their apt and synaptic</li>
<li>We still have the same poldek with no one to maintain it.</li>
</ul>

<p>And there's more. In particular libpoldek and python-poldek need to be completely redesigned to become usable in something even resembling a GUI tool. And there are some dependency interpretation issues too. More details further below.</p>

<h4>The solution</h4>

<p>I can see two solutions here. The first and most obvious is to find a new active maintainer and programmer for poldek. Sign up today, lots of fun and joy awaits you as you enter the abandoned world. There are some things to fix, some to refactor and maybe a little set of desired new features too.</p>

<p>The other solution is to introduce a new package manager with equal rights to those of poldek. That means keeping it up to date and making sure it always works. I've already taken the first step and PLD now has basic yum compatibility. There are yum repositories, there is yum and yumex — a nice little GUI tool to help all desktop users out there. This way we can avoid being chained to a single tool that in future could turn into a single point of failure.</p>

<p>However adding yum is not enough as there is something more…</p>

<h4>Poldek's architecture</h4>

<p>Long time ago in the galaxy not so far away a tool was created to aid package management. It was called poldek and it relied and still relies on a broken idea of calling rpm directly instead of using proper librpm bindings. This in turn forced poldek to reinvent a mechanism for dependency checks.</p>

<p>Most tools just pass the list of packages to librpm and the library in turn asks them what to do in specific cases (like unsatisfied deps or file conflicts). Poldek needed external one because there was no way to ask the rpm binary for anything and get usable feedback. It was either a success or a failure so every single check in rpm had to be doubled in poldek's code to detect all errors before asking rpm to jump in and do its job.</p>

<p>Then the High Council of One decided it was worth caching the rpm's database in yet another database but this time using a different schema. That's why poldek takes up to several minutes on some machines every other restart (when you see a <q>rebuilding rpm database</q> message).</p>

<p>The result? Yum's sources take as much as 2.4MB versus 35MB for poldek.</p>

<h4>Inconsistent dependency checks</h4>

<p>There are some problems adapting any other tool for PLD however. The reason is that for quite a long time noone bothered to use any other tool to manage packages. And PLD was fixed for poldek and poldek was fixed for PLD. And none of them handle the dependencies like the rest of the world does.</p>

<p>For some reason PLD decided to use the Obsoletes header to hold information about conflicting packages. Not that it makes any sense but that's how poldek implemented it in the first place. You see, when you try to use the proper Conflicts header and drop the Obsoletes header poldek displays an error message and refuses to install anything.</p>

<p>Patching yum to handle conflicts and uninstall the conflicting package took me about 3 minutes. But it treats Obsoletes the way it was supposed to be used: to tell the manager that a package is being dropped from the distribution and another one provides a replacement. Not that two packages are mutually exclusive (hint: mutual Conflicts). Now image what yum does when it sees two mutually obsoleting packages. Yup. It cycles them every time you upgrade. And now the fun part — we have more than 10 <q>issue</q> versions (send your answers on post cards to my home address).</p>

<p>That's why I propose fixing out packaging policy and poldek to handle deps like the rest of the world does (and maybe start using Suggests once poldek is fixed).</p>
